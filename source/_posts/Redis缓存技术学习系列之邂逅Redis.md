---
abbrlink: 3032366281
categories:
- 数据存储
date: 2017-03-30 23:31:40
description: ​        好了，这就是这篇博客的内容了，自我感觉 Redis 中的内容相对分散，这种细小的知识点都隐藏在命令中，最初在介绍不同的数据类型的时候，在文章中均做了详细的介绍并辅以终端脚本，可是最后发现这样写下去还不如去看官方文档，像 Redis 这种即使学习了都不见得有机会使用的技术，当然我并不是说 Redis 不好啊，关系型数据库目前依然是主流的技术驱动力量，所以我觉得我们学习的时候最好是“观其大略”、“不求甚解”，首先注重整体知识体系上的理解，微枝末叶上的细节问题可以在使用的时候去查阅文档;我们知道 Redis 是一个键-值数据库，所以在了解了 Redis 中支持的数据类型，即“值”以后，现在让我们将关注点回归到“键”上面来，这是因为作为一个键-值数据库，键是我们从数据库中获取值的唯一方式，因此在这里说说 Redis 中那些和键有关的命令，这些命令基本都遵循下面的命名格式，常见的命令有：;Redis 是一个采用键-值存储方案的数据库，因而传统关系型数据库里的 SQL 在这里将不再适用
tags:
- Redis
- 缓存
- 数据库
- 笔记
title: Redis 缓存技术学习系列之邂逅 Redis
---

&emsp;&emsp;作为一个反主流的开发者，在某种程度上，我对传统关系型数据库一直有点“讨厌”，因为关系型数据库实际上和面向对象思想是完全冲突的，前者建立在数学集合理论的基础上，而后者则是建立在软件工程基本原则的基础上。虽然传统的 ORM、序列化/反序列化在一定程度上解决了这种冲突，但是软件开发中关于使用原生 SQL 语句还是使用 ORM 框架的争论从来没有停止过。可是实际的业务背景中，是完全无法脱离数据库的，除非在某些特定的场合下，考虑到信息安全因素而禁止开发者使用数据库，在主流技术中数据库是一个非常重要的组成部分。为了弥补这个技术上的短板，从这篇文章开始，我将会学习一个经典的缓存技术：Redis。我们这里将 Redis 定性为一门缓存技术，这说明 Redis 和 MySQL 等主流的数据库存在本质上的区别，那么这些区别到底在哪里呢？或许在看完这个系列文章以后，你心中自然就会有了答案。

<!--more-->

# Redis 是什么
&emsp;&emsp;Redis 是什么?这是本文第一个问题。Redis 是一个开源的使用 ANSI C 语言编写的、支持网络、 基于内存的、支持持久化的日志型、Key-Value 数据库。从如此丰富的修饰语中，我们基本可以抽离出这些信息：

* Redis 是一个 Key-Value 存储系统
* Redis 的数据全部缓存在内存里
* Redis 可以通过网络实现主从同步
* Redis 支持丰富的数据类型可实现持久化

  那么该如何给 Redis 一个准确的定义呢？或许这个定义可以帮助我们更好的理解 Redis，即 Redis 是一个高性能的 Key-Value 数据库。我们知道主流的数据存储方案，可以分为关系型数据库和非关系型数据库两大类。传统的 Oracle、MySQL 和 SQLServer 都是关系型数据库，关系型数据库将复杂的数据结构归结为二元关系，即二维表形式，而对数据的操作则建立在一个或多个关系表格中，并通过这些表格间的分类、合并、连接和选取等运算实现数据处理。如同天地万物，有阴影的地方就会有阳光。和关系型数据库相对应的，我们称之为非关系型数据库，这是一个泛指的概念。实际上非关系型数据库，根据设计原理的不同，具体可分为：键-值存储数据库、列存储数据库、文档数据库和图数据库四种。我们通常称非关系型数据库为 NoSQL，即"Not Only SQL"，从这个概念我们或许可以明白，SQL 和 NoSQL 并非是完全对立的两个世界，它们各自在其擅长的应用场景中发挥着重要的作用。

  所以我选择 Redis 这样一个非关系型数据库，从某种意义上来说，我是想说明一件事情，数据库技术并非绝对代表着关系型数据库和 SQL，实际上 SQL 这门语言存在一定缺陷，就像我们提及 Web 技术常常想到是如何去做一个网站(MVC)，可你同样会意识到 Web API 是更为重要的 Web 技术。这个世界并非是一成不变的，每一天都是新的挑战。

# 开始使用 Redis
  好了，在了解了 Redis 是一个什么东西以后，现在我们来正式开始使用 Redis。Redis 作为一个开源的键-值数据库，我们可以从它的[官方网站](https://redis.io/)或者是从[Github](https://github.com/antirez/redis)来获取。这里推荐从官方网站下载相对稳定的版本，这里博主选择的是 3.2.8 版本，需要注意我们这里从官方网站下载的是源代码版本，所以首先第一件事情就是编译源代码。如果你非常擅长在 Window 下编译类似项目，可以尝试在 Windows 下进行编译。博主这里推荐大家使用 Linux 或者 MacOS 来编译，因为主流开源项目使用的 Makefile 都是 Unix 世界里的产物，所以使用 Linux 或者 MacOS 能够为我们节省大量的时间。博主这里使用的是 Elementary OS 这个 Linux 发行版(对应 Ubuntu14)，编译方法如下：



## Redis 的编译与安装

```plain
$ wget http://download.redis.io/releases/redis-3.2.8.tar.gz
$ tar xzf redis-3.2.8.tar.gz
$ cd redis-3.2.8
$ make
```
  在这里，除了 make 的步骤严格依赖命令行以外，其余的步骤都可以手动完成，所以因为惧怕命令行而不愿意接触 Linux 的世界，事实证明，对一个真正的程序员来讲，命令行是一个唯一可以让人不被外界所干扰的高效地工具，Git 是这个世界上最好没有之一的版本控制工具，如果你喜欢 Git，那么你更应该尝试去喜欢 Linux。好了，在完成对 Redis 的编译后，我们就可以开始使用 Redis 了。Redis 是一个 C/S 架构的键-值数据库，这意味着我们需要 Redis 的服务端程序和客户端程序。在完成编译以后，我们将得到 redis-server 和 redis-cli 这两个内置服务端程序和客户端程序。实际使用中我们会接触到不同语言下的 redis 客户端，在这里我们直接使用 Redis 内置的客户端：

```plain
//开启Redis服务
$ src/redis-server
//开启Redis客户端
$ src/redis-cli
```

  需要注意的是在这里服务端和客户端，是在两个不同的终端窗口中运行的，当我们看到下面的窗口时，即表明 Redis 服务开启就绪，此时我们就可以通过客户端来输入各种命令来完成数据的存取，默认情况下 Redis 每次会随机分配一个端口，这里 Redis 采用 6379 端口进行通信：

![Redis服务](https://ww1.sinaimg.cn/large/4c36074fly1fz68jad5qcj211y0laq73.jpg)

  Redis 是一个采用键-值存储方案的数据库，因而传统关系型数据库里的 SQL 在这里将不再适用。你可以将 Redis 理解为一个字典，我们可以向这个字典中储存任何 Redis 支持的数据类型，并通过键名来获取字典中存储的对应数值。我们来看下面的例子，以下命令均在 redis-cli 中执行：

```plain
SET foo bar
OK
GET foo
"bar"
```

## Redis 中支持的数据类型

  这个例子演示了如何在 Redis 中存储和读取一个简单的字符串类型的值，看起来这一切都非常简单啊，的确 Redis 就是这样一个简单而高效的键-值数据库。我们在前面提到 Redis 支持各种各样的数据类型，那么它到底支持哪些数据类型呢？具体来讲，Redis 支持 5 种基本的数据类型：

* 字符串(Strings)：最基本的数据类型，使用 SET/GET 命令来存储和读取字符串类型的值。在 Redis 中最多可支持 512 兆字节的字符串长度，这意味着我们可以常见的数据类型序列化后再存储到 Redis 中。
* 散列/哈希(Hashes)：专门用来表示对象的数据类型。散列/哈希是键-值对的集合，可以维系字符串字段和字符串值间的映射关系，因此它主要用来表示对象。在 Redis 中可以使用 HMSET、HMGET、HGET、HGETALL 四种命令来存储和读取散列类型的值。
* 列表(Lists)：指按照插入顺序排序的字符串元素的集合，特别地，Redis 中的列表是采用链表实现的，因为对数据库系统而言，一个非常重要的特性是可以支持在含有大量元素的集合中快速添加元素。常见的应用于列表的命令主要有 LPUSH、RPUSH、LPOP、RPOP 和 LRANGE。
* 集合(Sets)：指不重复且无序的字符串元素的集合。针对列表，常见的命令主要有：SADD、SPOP、SCARD、SMEMBERS 和 SISMEMBER。例如 SADD 命令可以向集合中添加元素，SPOP 命令可以从集合中删除元素，SCARD 命令可以返回集合内元素个数，SMERMERS 命令可以枚举集合的所有元素，SISMEMBER 命令可以判断指定元素是否在指定集合内。
* 有序集合(Sorted Sets)：有序集合与集合相似，不同点在于集合中的每一个元素都会关联一个浮点型的数值，该数值称为 score，事实上 Redis 正是根据 score 来对集合内的元素进行排序的。集合内的元素是不允许重复的，但是 score 是可以允许重复的。常见的命令有：ZADD、ZCARD、ZCOUNT、ZREM、ZSCORE 等。


## Redis 中和键有关的命令

  我们知道 Redis 是一个键-值数据库，所以在了解了 Redis 中支持的数据类型，即“值”以后，现在让我们将关注点回归到“键”上面来，这是因为作为一个键-值数据库，键是我们从数据库中获取值的唯一方式，因此在这里说说 Redis 中那些和键有关的命令，这些命令基本都遵循下面的命名格式，常见的命令有：

```plain
COMMAND KEY_NAME
```

* DEL：该命令将在键名存在时从数据库中删除指定键，成功则返回 1，否则返回 0。
* DUMP：该命令将序列化指定键，并返回被序列化的值。
* EXISTS：该命令用以判断指定键是否存在。
* EXPIRE：该命令用以给指定键设置过期时间。
* KEYS：该命令用以返回所有满足匹配模式的键。
* PERSIST：该命令用以移除指定键的过期时间。
* RENAME：该命令用以重命名指定键。

​        好了，这就是这篇博客的内容了，自我感觉 Redis 中的内容相对分散，这种细小的知识点都隐藏在命令中，最初在介绍不同的数据类型的时候，在文章中均做了详细的介绍并辅以终端脚本，可是最后发现这样写下去还不如去看官方文档，像 Redis 这种即使学习了都不见得有机会使用的技术，当然我并不是说 Redis 不好啊，关系型数据库目前依然是主流的技术驱动力量，所以我觉得我们学习的时候最好是“观其大略”、“不求甚解”，首先注重整体知识体系上的理解，微枝末叶上的细节问题可以在使用的时候去查阅文档。在下面的文章中，我重点关注的内容是 Redis 的**事务**、**脚本**、**发布/订阅**及**不同语言下 Redis 的使用**，希望大家继续关注我的博客，本篇结束！