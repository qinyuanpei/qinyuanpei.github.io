var InstantClick=function(o,r){function a(t){var e=t.indexOf("#");return e<0?t:t.substr(0,e)}function n(t){for(;t&&"A"!=t.nodeName;)t=t.parentNode;return t}function s(t){var e=r.protocol+"//"+r.host;if(!(e=t.target||t.hasAttribute("download")||0!=t.href.indexOf(e+"/")||-1<t.href.indexOf("#")&&a(t.href)==v)){if(L){t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-no-instant"))break;if(t.hasAttribute("data-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}t=!t}else t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-instant"))break;if(t.hasAttribute("data-no-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}e=t}return!e}function d(t,e,n,i){for(var r,a=!1,o=0;o<X[t].length;o++)"receive"==t?(r=X[t][o](e,n,i))&&("body"in r&&(n=r.body),"title"in r&&(i=r.title),a=r):X[t][o](e,n,i);return a}function l(t,e,n,i){if(o.documentElement.replaceChild(e,o.body),n){if(history.pushState(null,null,n),i=0,e=-1<(e=n.indexOf("#"))&&o.getElementById(n.substr(e+1)))for(;e.offsetParent;)i+=e.offsetTop,e=e.offsetParent;scrollTo(0,i),v=a(n)}else scrollTo(0,i);o.title=Y&&o.title==t?t+String.fromCharCode(160):t,m(),q.done(),d("change",!1),(t=o.createEvent("HTMLEvents")).initEvent("instantclick:newpage",!0,!0),dispatchEvent(t)}function c(t){E>+new Date-500||(t=n(t.target))&&s(t)&&y(t.href)}function f(t){E>+new Date-500||(t=n(t.target))&&s(t)&&(t.addEventListener("mouseout",e),A?(g=t.href,T=setTimeout(y,A)):y(t.href))}function h(t){E=+new Date,(t=n(t.target))&&s(t)&&(k?t.removeEventListener("mousedown",c):t.removeEventListener("mouseover",f),y(t.href))}function u(t){var e=n(t.target);!e||!s(e)||1<t.which||t.metaKey||t.ctrlKey||(t.preventDefault(),b(e.href))}function e(){T?(clearTimeout(T),T=!1):K&&!P&&(w.abort(),P=K=!1)}function p(){if(!(w.readyState<4)&&0!=w.status){if(W.ready=+new Date-W.start,w.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=o.implementation.createHTMLDocument("");t.documentElement.innerHTML=w.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),S=t.title,z=t.body,(e=d("receive",N,z,S))&&("body"in e&&(z=e.body),"title"in e&&(S=e.title)),e=a(N),B[e]={body:z,title:S,scrollY:e in B?B[e].scrollY:0};for(var e=0,n=(t=t.head.children).length-1;0<=n;n--)if((i=t[n]).hasAttribute("data-instant-track"))for(var i=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML,r=R.length-1;0<=r;r--)R[r]==i&&e++;e!=R.length&&(I=!0)}else I=!0;P&&(P=!1,b(N))}}function m(t){var e,n,r,a;if(o.body.addEventListener("touchstart",h,!0),k?o.body.addEventListener("mousedown",c,!0):o.body.addEventListener("mouseover",f,!0),o.body.addEventListener("click",u,!0),!t)for(t=o.body.getElementsByTagName("script"),i=0,j=t.length;i<j;i++)(e=t[i]).hasAttribute("data-no-instant")||(n=o.createElement("script"),e.src&&(n.src=e.src),e.innerHTML&&(n.innerHTML=e.innerHTML),r=e.parentNode,a=e.nextSibling,r.removeChild(e),r.insertBefore(n,a))}function y(t){!k&&"display"in W&&+new Date-(W.start+W.display)<100||(T&&(clearTimeout(T),T=!1),t=t||g,K&&(t==N||P))||(N=t,I=z=P=!(K=!0),W={start:+new Date},d("fetch"),w.open("GET",t),w.send())}function b(t){"display"in W||(W.display=+new Date-W.start),T||!K?T&&N&&N!=t?r.href=t:(y(t),q.start(0,!0),d("wait"),P=!0):P?r.href=t:I?r.href=N:z?(B[v].scrollY=pageYOffset,P=K=!1,l(S,z,N)):(q.start(0,!0),d("wait"),P=!0)}var v,g,T,E,w,L,k,A,x,C,M,O,H,t=navigator.userAgent,Y=-1<t.indexOf(" CriOS/"),D="createTouch"in o,B={},N=!1,S=!1,I=!1,z=!1,W={},K=!1,P=!1,R=[],X={fetch:[],receive:[],wait:[],change:[]},q={init:function(){(x=o.createElement("div")).id="instantclick",(C=o.createElement("div")).id="instantclick-bar",C.className="instantclick-bar",x.appendChild(C);var t=["Webkit","Moz","O"];if(!((M="transform")in C.style))for(var e=0;e<3;e++)t[e]+"Transform"in C.style&&(M=t[e]+"Transform");var n="transition";if(!(n in C.style))for(e=0;e<3;e++)t[e]+"Transition"in C.style&&(n="-"+t[e].toLowerCase()+"-"+n);(t=o.createElement("style")).innerHTML="#instantclick{position:"+(D?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+n+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+n+":all .25s}",o.head.appendChild(t),D&&(V(),addEventListener("resize",V),addEventListener("scroll",V))},start:F,done:function t(){o.getElementById(x.id)?(clearTimeout(H),O=100,U(),x.style.opacity="0"):(F(100==O?0:O),setTimeout(t,0))}},G="pushState"in history&&(!t.match("Android")||t.match("Chrome/"))&&"file:"!=r.protocol;function F(t,e){O=t,o.getElementById(x.id)&&o.body.removeChild(x),x.style.opacity="1",o.getElementById(x.id)&&o.body.removeChild(x),U(),e&&setTimeout(J,0),clearTimeout(H),H=setTimeout(Q,500)}function J(){O=10,U()}function Q(){98<=(O+=1+2*Math.random())?O=98:H=setTimeout(Q,500),U()}function U(){C.style[M]="translate("+O+"%)",o.getElementById(x.id)||o.body.appendChild(x)}function V(){x.style.left=pageXOffset+"px",x.style.width=innerWidth+"px",x.style.top=pageYOffset+"px";var t="orientation"in window&&90==Math.abs(orientation);x.style[M]="scaleY("+innerWidth/screen[t?"height":"width"]*2+")"}return{supported:G,init:function(){if(!v)if(G){for(var t=arguments.length-1;0<=t;t--)!0===(e=arguments[t])?L=!0:"mousedown"==e?k=!0:"number"==typeof e&&(A=e);v=a(r.href),B[v]={body:o.body,title:o.title,scrollY:pageYOffset};for(var e,n,t=(e=o.head.children).length-1;0<=t;t--)(n=e[t]).hasAttribute("data-instant-track")&&(n=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML,R.push(n));(w=new XMLHttpRequest).addEventListener("readystatechange",p),m(!0),q.init(),d("change",!0),addEventListener("popstate",function(){var t=a(r.href);t!=v&&(t in B?(B[v].scrollY=pageYOffset,l(B[v=t].title,B[t].body,!1,B[t].scrollY)):r.href=r.href)})}else d("change",!0)},on:function(t,e){X[t].push(e)}}}(document,location);