var InstantClick=function(o,r){function a(t){var e=t.indexOf("#");return e<0?t:t.substr(0,e)}function n(t){for(;t&&"A"!=t.nodeName;)t=t.parentNode;return t}function s(t){var e=r.protocol+"//"+r.host;if(!(e=t.target||t.hasAttribute("download")||0!=t.href.indexOf(e+"/")||-1<t.href.indexOf("#")&&a(t.href)==u)){if(q){t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-no-instant"))break;if(t.hasAttribute("data-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}t=!t}else t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-instant"))break;if(t.hasAttribute("data-no-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}e=t}return!e}function d(t,e,n,i){for(var r,a=!1,o=0;o<B[t].length;o++)"receive"==t?(r=B[t][o](e,n,i))&&("body"in r&&(n=r.body),"title"in r&&(i=r.title),a=r):B[t][o](e,n,i);return a}function l(t,e,n,i){if(o.documentElement.replaceChild(e,o.body),n){if(history.pushState(null,null,n),i=0,e=-1<(e=n.indexOf("#"))&&o.getElementById(n.substr(e+1)))for(;e.offsetParent;)i+=e.offsetTop,e=e.offsetParent;scrollTo(0,i),u=a(n)}else scrollTo(0,i);o.title=G&&o.title==t?t+String.fromCharCode(160):t,h(),N.done(),d("change",!1),(t=o.createEvent("HTMLEvents")).initEvent("instantclick:newpage",!0,!0),dispatchEvent(t)}function c(t){m>+new Date-500||(t=n(t.target))&&s(t)&&e(t.href)}function f(t){m>+new Date-500||(t=n(t.target))&&s(t)&&(t.addEventListener("mouseout",K),v?(X=t.href,p=setTimeout(e,v)):e(t.href))}function z(t){m=+new Date,(t=n(t.target))&&s(t)&&(b?t.removeEventListener("mousedown",c):t.removeEventListener("mouseover",f),e(t.href))}function W(t){var e=n(t.target);!e||!s(e)||1<t.which||t.metaKey||t.ctrlKey||(t.preventDefault(),R(e.href))}function K(){p?(clearTimeout(p),p=!1):H&&!Y&&(y.abort(),Y=H=!1)}function P(){if(!(y.readyState<4)&&0!=y.status){if(O.ready=+new Date-O.start,y.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=o.implementation.createHTMLDocument("");t.documentElement.innerHTML=y.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),x=t.title,M=t.body,(e=d("receive",A,M,x))&&("body"in e&&(M=e.body),"title"in e&&(x=e.title)),e=a(A),k[e]={body:M,title:x,scrollY:e in k?k[e].scrollY:0};for(var e=0,n=(t=t.head.children).length-1;0<=n;n--)if((i=t[n]).hasAttribute("data-instant-track"))for(var i=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML,r=D.length-1;0<=r;r--)D[r]==i&&e++;e!=D.length&&(C=!0)}else C=!0;Y&&(Y=!1,R(A))}}function h(t){var e,n,r,a;if(o.body.addEventListener("touchstart",z,!0),b?o.body.addEventListener("mousedown",c,!0):o.body.addEventListener("mouseover",f,!0),o.body.addEventListener("click",W,!0),!t)for(t=o.body.getElementsByTagName("script"),i=0,j=t.length;i<j;i++)(e=t[i]).hasAttribute("data-no-instant")||(n=o.createElement("script"),e.src&&(n.src=e.src),e.innerHTML&&(n.innerHTML=e.innerHTML),r=e.parentNode,a=e.nextSibling,r.removeChild(e),r.insertBefore(n,a))}function e(t){!b&&"display"in O&&+new Date-(O.start+O.display)<100||(p&&(clearTimeout(p),p=!1),t=t||X,H&&(t==A||Y))||(A=t,C=M=Y=!(H=!0),O={start:+new Date},d("fetch"),y.open("GET",t),y.send())}function R(t){"display"in O||(O.display=+new Date-O.start),p||!H?p&&A&&A!=t?r.href=t:(e(t),N.start(0,!0),d("wait"),Y=!0):Y?r.href=t:C?r.href=A:M?(k[u].scrollY=pageYOffset,Y=H=!1,l(x,M,A)):(N.start(0,!0),d("wait"),Y=!0)}var u,X,p,m,y,q,b,v,g,T,E,w,L,t=navigator.userAgent,G=-1<t.indexOf(" CriOS/"),F="createTouch"in o,k={},A=!1,x=!1,C=!1,M=!1,O={},H=!1,Y=!1,D=[],B={fetch:[],receive:[],wait:[],change:[]},N={init:function(){(g=o.createElement("div")).id="instantclick",(T=o.createElement("div")).id="instantclick-bar",T.className="instantclick-bar",g.appendChild(T);var t=["Webkit","Moz","O"];if(!((E="transform")in T.style))for(var e=0;e<3;e++)t[e]+"Transform"in T.style&&(E=t[e]+"Transform");var n="transition";if(!(n in T.style))for(e=0;e<3;e++)t[e]+"Transition"in T.style&&(n="-"+t[e].toLowerCase()+"-"+n);(t=o.createElement("style")).innerHTML="#instantclick{position:"+(F?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+n+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+n+":all .25s}",o.head.appendChild(t),F&&(I(),addEventListener("resize",I),addEventListener("scroll",I))},start:Q,done:function t(){o.getElementById(g.id)?(clearTimeout(L),w=100,S(),g.style.opacity="0"):(Q(100==w?0:w),setTimeout(t,0))}},J="pushState"in history&&(!t.match("Android")||t.match("Chrome/"))&&"file:"!=r.protocol;function Q(t,e){w=t,o.getElementById(g.id)&&o.body.removeChild(g),g.style.opacity="1",o.getElementById(g.id)&&o.body.removeChild(g),S(),e&&setTimeout(U,0),clearTimeout(L),L=setTimeout(V,500)}function U(){w=10,S()}function V(){98<=(w+=1+2*Math.random())?w=98:L=setTimeout(V,500),S()}function S(){T.style[E]="translate("+w+"%)",o.getElementById(g.id)||o.body.appendChild(g)}function I(){g.style.left=pageXOffset+"px",g.style.width=innerWidth+"px",g.style.top=pageYOffset+"px";var t="orientation"in window&&90==Math.abs(orientation);g.style[E]="scaleY("+innerWidth/screen[t?"height":"width"]*2+")"}return{supported:J,init:function(){if(!u)if(J){for(var t=arguments.length-1;0<=t;t--)!0===(e=arguments[t])?q=!0:"mousedown"==e?b=!0:"number"==typeof e&&(v=e);u=a(r.href),k[u]={body:o.body,title:o.title,scrollY:pageYOffset};for(var e,n,t=(e=o.head.children).length-1;0<=t;t--)(n=e[t]).hasAttribute("data-instant-track")&&(n=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML,D.push(n));(y=new XMLHttpRequest).addEventListener("readystatechange",P),h(!0),N.init(),d("change",!0),addEventListener("popstate",function(){var t=a(r.href);t!=u&&(t in k?(k[u].scrollY=pageYOffset,l(k[u=t].title,k[t].body,!1,k[t].scrollY)):r.href=r.href)})}else d("change",!0)},on:function(t,e){B[t].push(e)}}}(document,location);