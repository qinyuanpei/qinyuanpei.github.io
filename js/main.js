function p(){({types:["light","dark","auto"],currentType:"auto",icons:{light:"icon-sun",dark:"icon-moon",auto:"icon-auto"},toggle(){let n=(this.types.indexOf(this.currentType)+1)%this.types.length;this.currentType=this.types[n],this.apply(),localStorage.setItem("theme",this.currentType),this.updateIcon()},apply(){let e=document.documentElement;if(this.types.forEach(n=>{e.classList.remove(n)}),this.currentType==="auto"){let o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.classList.add(o)}else e.classList.add(this.currentType);console.log("\u5F53\u524D\u6A21\u5F0F\uFF1A",this.currentType)},updateIcon(){let e=document.getElementById("themeIcon");e&&(e.className=`iconfont ${this.icons[this.currentType]}`)},init(){let e=localStorage.getItem("theme");e&&this.types.includes(e)&&(this.currentType=e),this.apply(),this.updateIcon(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.currentType==="auto"&&this.apply()});let n=document.getElementById("themeToggle");n&&n.addEventListener("click",()=>this.toggle())}}).init()}function f(){({toggle(){let e=document.getElementById("mobileMenu");e&&(e.style.display=e.style.display==="none"?"block":"none")},init(){let e=document.querySelector(".nav-btn.mobile");e&&e.addEventListener("click",()=>this.toggle());let n=document.querySelector(".mobile-menu .close-control"),o=document.querySelector(".mobile-menu .menu-mask");n&&n.addEventListener("click",()=>this.toggle()),o&&o.addEventListener("click",()=>this.toggle())}}).init()}function y(){if(typeof Fancybox>"u"){console.error("Fancybox \u521D\u59CB\u5316\u5F02\u5E38");return}Fancybox.bind("[data-fancybox]",{hideScrollbar:!0,Carousel:{transition:"slide"},Hash:!1,Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY"],right:["slideshow","thumbs","close"]}},l10n:{PANUP:"\u4E0A\u79FB",PANDOWN:"\u4E0B\u79FB",PANLEFT:"\u5DE6\u79FB",PANRIGHT:"\u53F3\u79FB",ZOOMIN:"\u653E\u5927",ZOOMOUT:"\u7F29\u5C0F",TOGGLEZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",TOGGLE1TO1:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",ITERATEZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",ROTATECCW:"\u9006\u65F6\u9488\u65CB\u8F6C",ROTATECW:"\u987A\u65F6\u9488\u65CB\u8F6C",FLIPX:"\u6C34\u5E73\u7FFB\u8F6C",FLIPY:"\u5782\u76F4\u7FFB\u8F6C",FITX:"\u6C34\u5E73\u9002\u5E94",FITY:"\u5782\u76F4\u9002\u5E94",RESET:"\u91CD\u7F6E",TOGGLEFS:"\u5207\u6362\u5168\u5C4F",CLOSE:"\u5173\u95ED",NEXT:"\u4E0B\u4E00\u4E2A",PREV:"\u4E0A\u4E00\u4E2A",MODAL:"\u4F7F\u7528 ESC \u952E\u5173\u95ED",ERROR:"\u53D1\u751F\u4E86\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5",IMAGE_ERROR:"\u627E\u4E0D\u5230\u56FE\u50CF",ELEMENT_NOT_FOUND:"\u627E\u4E0D\u5230 HTML \u5143\u7D20",AJAX_NOT_FOUND:"\u8F7D\u5165 AJAX \u65F6\u51FA\u9519: \u672A\u627E\u5230",AJAX_FORBIDDEN:"\u8F7D\u5165 AJAX \u65F6\u51FA\u9519: \u88AB\u963B\u6B62",IFRAME_ERROR:"\u52A0\u8F7D\u9875\u9762\u51FA\u9519",TOGGLE_ZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",TOGGLE_THUMBS:"\u5207\u6362\u7F29\u7565\u56FE",TOGGLE_SLIDESHOW:"\u5207\u6362\u5E7B\u706F\u7247",TOGGLE_FULLSCREEN:"\u5207\u6362\u5168\u5C4F",DOWNLOAD:"\u4E0B\u8F7D"}})}var g={searchData:[],searchOptions:{keys:["title","content"]},fuse:null,toggleSearch(){window.$Modal.isVisible("search-modal")?window.$Modal.hide("search-modal"):(window.$Modal.show("search-modal"),document.getElementById("search-input").focus())},search(t){let e=document.querySelector(".search-list"),n=document.querySelector(".search-empty"),o=document.querySelector("#search-hint-text"),i=performance.now(),s=this.fuse.search(t);s.length===0?(e.style.display="none",n.style.display="flex"):(e.style.display="block",n.style.display="none",e.innerHTML=s.map(r=>r.item).map(r=>`
                <div class="search-item" onclick="window.location.href='${r.permalink}'">
                    <div class="search-item-title">${this.highlightKeyword(r.title,t)}</div>
                    <div class="search-item-content">${this.highlightKeyword(this.truncateContent(r.content,t),t)}</div>
                </div>
            `).join(""));let c=performance.now();o.innerHTML=`\u672C\u6B21\u7528\u65F6 ${Math.round(c-i)} \u6BEB\u79D2`},highlightKeyword(t,e){if(!e)return t;let n=new RegExp(e,"gi");return t.replace(n,o=>`<mark>${o}</mark>`)},truncateContent(t,e,n=200){if(t.length<=n)return t;if(e){let o=t.toLowerCase().indexOf(e.toLowerCase());if(o!==-1){let i=Math.max(0,o-Math.floor((n-e.length)/2)),s=Math.min(t.length,i+n);return t.substring(i,s)+"..."}}return t.substring(0,n)+"..."},init(){this.reset(),document.getElementById("search-input").addEventListener("input",e=>{let n=e.target.value.trim();n||this.reset(),this.search(n)});let t=document.querySelector('.nav-btn[title="\u5168\u7AD9\u641C\u7D22"]');t&&t.addEventListener("click",()=>this.toggleSearch()),fetch("/index.json").then(e=>e.json()).then(e=>{this.searchData=e,this.fuse=new Fuse(this.searchData,this.searchOptions)})},reset(){let t=document.querySelector(".search-list"),e=document.querySelector(".search-empty"),n=document.querySelector("#search-hint-text");n.innerHTML="",t.innerHTML="",t.style.display="none",e.style.display="flex"}};window.$Search=g;function E(){g.init()}function S(t,e){let n=null,o=0;return function(){let i=Date.now(),s=e-(i-o);s<=0||s>e?(n&&(clearTimeout(n),n=null),o=i,t.apply(this,arguments)):n||(n=setTimeout(()=>{o=Date.now(),n=null,t.apply(this,arguments)},s))}}function h(){let t=document.querySelector(".main-nav"),e=document.querySelector(".to-top"),n=document.querySelector(".to-top .num"),o=window.scrollY||window.pageYOffset,i=document.documentElement.scrollHeight-window.innerHeight,s=(o/i*100).toFixed(0);o===0?t.classList.add("top"):t.classList.remove("top");let c=o>(h.lastScrollY||0)?"down":"up";h.lastScrollY=o,t.classList.remove("up","down"),t.classList.add(c),o===0?e.classList.add("hidden"):e.classList.remove("hidden"),n&&(n.textContent=s),s>90?(n.textContent="\u8FD4\u56DE\u9876\u90E8",e.classList.add("long")):e.classList.remove("long")}function T(){window.scrollTo({top:0,behavior:"smooth"})}function L(){h(),window.addEventListener("scroll",S(h,300));let t=document.querySelector(".to-top");t&&t.addEventListener("click",T);let e=document.querySelector(".site-title");e&&e.addEventListener("click",T)}function x(){let t=document.getElementById("next-post"),e=document.getElementById("page-content");if(!t||!e)return;let n=null,o=t.getAttribute("data-is-next")==="true",i=!1,s=()=>{n&&n.disconnect(),n=new IntersectionObserver(a=>{a.forEach(l=>{i=!l.isIntersecting,c()})}),n.observe(e)},c=()=>{i?(t.classList.add("fixed","show"),t.style.transform="translateY(0)"):(t.classList.remove("show"),o?t.style.transform="translateY(180px)":t.style.transform="translateY(-180px)")},r=t.querySelector(".next-post-link");return r&&r.addEventListener("click",a=>{a.preventDefault();let l=r.getAttribute("href");l&&(t.style.opacity="0",t.style.transform=o?"translateY(180px)":"translateY(-180px)",setTimeout(()=>{window.location.href=l},300))}),s(),()=>{n&&n.disconnect()}}var w={modals:new Map,init(){document.querySelectorAll(".modal").forEach(t=>{let e=t.id;if(!e){console.error("Modal element must have an id!");return}let n={element:t,mask:t.querySelector(".modal-mask"),closeBtn:t.querySelector(".close"),isVisible:!1};n.mask?.addEventListener("click",()=>this.hide(e)),n.closeBtn?.addEventListener("click",()=>this.hide(e)),this.modals.set(e,n)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.modals.forEach((e,n)=>{e.isVisible&&this.hide(n)})})},show(t){let e=this.modals.get(t);if(!e){console.error(`Modal with id "${t}" not found!`);return}e.element.style.display="flex",document.body.style.overflowY="hidden",e.isVisible=!0,requestAnimationFrame(()=>{e.element.classList.add("show")})},hide(t){let e=this.modals.get(t);if(!e){console.error(`Modal with id "${t}" not found!`);return}e.element.classList.remove("show"),setTimeout(()=>{e.element.style.display="none",document.body.style.overflowY="",e.isVisible=!1},300)},isVisible(t){return this.modals.get(t)?.isVisible||!1}};window.$Modal=w;function v(){w.init()}function b(){hljs.highlightAll(),document.querySelectorAll("pre > code").forEach(t=>{let e=t.parentElement,n=document.createElement("div");n.className="highlight",e.parentNode.insertBefore(n,e);let o=t.getAttribute("data-lang")||t.className.match(/language-(\w+)/)?.[1]||"plaintext",i=document.createElement("div");i.className="highlight-header";let s=document.createElement("div");s.className="highlight-info";let c=document.createElement("span");c.className="highlight-lang",c.textContent=o,s.appendChild(c);let r=t.innerHTML.trim().split(`
`),a=document.createElement("span");a.textContent=`${r.length} \u884C`,a.style.display="none",s.appendChild(a),i.appendChild(s);let l=document.createElement("button");l.className="copy-button",l.textContent="\u590D\u5236",i.appendChild(l);let d=document.createElement("div");d.className="highlight-content";let m=document.createElement("div");m.className="line-numbers",m.innerHTML=r.map((u,M)=>`<span>${M+1}</span>`).join(""),d.appendChild(m),d.appendChild(e),n.appendChild(i),n.appendChild(d),l.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(t.textContent),l.textContent="\u5DF2\u590D\u5236",l.classList.add("copied"),setTimeout(()=>{l.textContent="\u590D\u5236",l.classList.remove("copied")},2e3)}catch(u){console.error("\u590D\u5236\u5931\u8D25:",u),l.textContent="\u590D\u5236\u5931\u8D25"}})})}function O(t){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}function C(){p(),f(),y(),E(),L(),x(),v(),b()}O(C);
